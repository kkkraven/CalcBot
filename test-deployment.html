<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç API - –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —É–ø–∞–∫–æ–≤–∫–∏</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-section h3 {
            margin-top: 0;
            color: #333;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 12px;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .loading {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }
        input, textarea {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea {
            height: 100px;
            resize: vertical;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API - –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —É–ø–∞–∫–æ–≤–∫–∏</h1>
        <p>–≠—Ç–æ—Ç —Ñ–∞–π–ª –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–µ–ø–ª–æ–µ–Ω–Ω–æ–≥–æ API –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.</p>

        <div class="test-section">
            <h3>üîó –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API</h3>
            <p>–¢–µ—Å—Ç–∏—Ä—É–µ–º –±–∞–∑–æ–≤—É—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Cloudflare Worker</p>
            <button onclick="testApiHealth()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ API</button>
            <div id="health-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>üîê –¢–µ—Å—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏</h3>
            <p>–ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É —Å –Ω–æ–≤—ã–º API –∫–ª—é—á–æ–º</p>
            <input type="text" id="api-key" placeholder="–í–≤–µ–¥–∏—Ç–µ API –∫–ª—é—á" value="80b230d76f854e765d7ddc77049a5008e964e561a80d3de5a111fa2fc9cc41ab">
            <button onclick="testAuthentication()">–¢–µ—Å—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏</button>
            <div id="auth-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>üì¶ –¢–µ—Å—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h3>
            <p>–¢–µ—Å—Ç–∏—Ä—É–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å</p>
            <textarea id="test-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è">–ö–∞—Ä—Ç–æ–Ω–Ω–∞—è –∫–æ—Ä–æ–±–∫–∞ –¥–ª—è —É–ø–∞–∫–æ–≤–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤, —Ä–∞–∑–º–µ—Ä—ã 30x20x15 —Å–º, —Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ 3–º–º, –±–µ–ª—ã–π —Ü–≤–µ—Ç, —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º</textarea>
            <button onclick="testParameterExtraction()">–ò–∑–≤–ª–µ—á—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</button>
            <div id="extraction-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>üí∞ –¢–µ—Å—Ç —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏</h3>
            <p>–¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —É–ø–∞–∫–æ–≤–∫–∏</p>
            <textarea id="price-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏">{"material": "–∫–∞—Ä—Ç–æ–Ω", "dimensions": {"length": 30, "width": 20, "height": 15}, "wallThickness": 3, "color": "–±–µ–ª—ã–π", "printing": "–ª–æ–≥–æ—Ç–∏–ø", "quantity": 1000}</textarea>
            <button onclick="testPriceCalculation()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å</button>
            <div id="price-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>üõ°Ô∏è –¢–µ—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h3>
            <p>–ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞—â–∏—Ç—É –æ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤</p>
            <button onclick="testSecurity()">–¢–µ—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</button>
            <div id="security-result" class="result" style="display: none;"></div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'https://packaging-calculator-api.46261vor.workers.dev';

        function showResult(elementId, content, isError = false) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.className = `result ${isError ? 'error' : 'success'}`;
            element.textContent = content;
        }

        function showLoading(elementId) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.className = 'result loading';
            element.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞...';
        }

        async function testApiHealth() {
            showLoading('health-result');
            try {
                const response = await fetch(`${API_BASE_URL}/health`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                const data = await response.text();
                showResult('health-result', `–°—Ç–∞—Ç—É—Å: ${response.status}\n–û—Ç–≤–µ—Ç: ${data}`);
            } catch (error) {
                showResult('health-result', `–û—à–∏–±–∫–∞: ${error.message}`, true);
            }
        }

        async function testAuthentication() {
            showLoading('auth-result');
            const apiKey = document.getElementById('api-key').value;
            
            try {
                const response = await fetch(`${API_BASE_URL}/health`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': apiKey
                    }
                });
                
                const data = await response.text();
                showResult('auth-result', `–°—Ç–∞—Ç—É—Å: ${response.status}\n–û—Ç–≤–µ—Ç: ${data}`);
            } catch (error) {
                showResult('auth-result', `–û—à–∏–±–∫–∞: ${error.message}`, true);
            }
        }

        async function testParameterExtraction() {
            showLoading('extraction-result');
            const apiKey = document.getElementById('api-key').value;
            const input = document.getElementById('test-input').value;
            
            try {
                const response = await fetch(`${API_BASE_URL}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': apiKey
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `–ò–∑–≤–ª–µ–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ —Å–ª–µ–¥—É—é—â–µ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ –∏ –≤–µ—Ä–Ω–∏ JSON-–º–∞—Å—Å–∏–≤ —Å –æ–±—ä–µ–∫—Ç–∞–º–∏, —Å–æ–¥–µ—Ä–∂–∞—â–∏–º–∏ –ø–æ–ª—è: material, dimensions (length, width, height), wallThickness, color, printing, quantity. –û–ø–∏—Å–∞–Ω–∏–µ: ${input}`
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.1,
                            max_tokens: 1000
                        }
                    })
                });
                
                const data = await response.json();
                showResult('extraction-result', `–°—Ç–∞—Ç—É—Å: ${response.status}\n–û—Ç–≤–µ—Ç: ${JSON.stringify(data, null, 2)}`);
            } catch (error) {
                showResult('extraction-result', `–û—à–∏–±–∫–∞: ${error.message}`, true);
            }
        }

        async function testPriceCalculation() {
            showLoading('price-result');
            const apiKey = document.getElementById('api-key').value;
            const input = document.getElementById('price-input').value;
            
            try {
                const params = JSON.parse(input);
                const response = await fetch(`${API_BASE_URL}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': apiKey
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `–†–∞—Å—Å—á–∏—Ç–∞–π —Å—Ç–æ–∏–º–æ—Å—Ç—å —É–ø–∞–∫–æ–≤–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–ª–µ–¥—É—é—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: ${JSON.stringify(params)}. –í–µ—Ä–Ω–∏ JSON —Å –ø–æ–ª—è–º–∏: totalCost, costPerUnit, breakdown`
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.1,
                            max_tokens: 1000
                        }
                    })
                });
                
                const data = await response.json();
                showResult('price-result', `–°—Ç–∞—Ç—É—Å: ${response.status}\n–û—Ç–≤–µ—Ç: ${JSON.stringify(data, null, 2)}`);
            } catch (error) {
                showResult('price-result', `–û—à–∏–±–∫–∞: ${error.message}`, true);
            }
        }

        async function testSecurity() {
            showLoading('security-result');
            const apiKey = document.getElementById('api-key').value;
            
            try {
                // –¢–µ—Å—Ç —Å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º —Å–∫—Ä–∏–ø—Ç–æ–º
                const maliciousInput = '<script>alert("XSS")</script>';
                const response = await fetch(`${API_BASE_URL}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': apiKey
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `–ò–∑–≤–ª–µ–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: ${maliciousInput}`
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.1,
                            max_tokens: 1000
                        }
                    })
                });
                
                const data = await response.json();
                const isSanitized = !data.text || !data.text.includes('<script>');
                showResult('security-result', `–°—Ç–∞—Ç—É—Å: ${response.status}\n–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç: ${isSanitized ? '–î–ê' : '–ù–ï–¢'}\n–û—Ç–≤–µ—Ç: ${JSON.stringify(data, null, 2)}`);
            } catch (error) {
                showResult('security-result', `–û—à–∏–±–∫–∞: ${error.message}`, true);
            }
        }
    </script>
</body>
</html>
